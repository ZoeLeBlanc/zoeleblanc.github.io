jQuery(function(){function e(e){var a=$("#search_results");e.length?(a.empty(),e.forEach(function(e){var d=window.documents.filter(t=>t.id===e.ref),o=n(d[0]);Object.keys(e.matchData.metadata).forEach(function(n){Object.keys(e.matchData.metadata[n]).forEach(function(a){t(o.querySelector("[data-field="+a+"]"),e.matchData.metadata[n][a].position)})}),a.append(o)})):a.html("<li>No results found.<br/>Please check spelling, spacing, yada...</li>")}function t(e,t){var n,a={acceptNode:function(e){return/^[\t\n\r ]*$/.test(e.nodeValue)?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}},d=0,o=[-1,-1],r=(t=t.sort(function(e,t){return e[0]-t[0]}).slice()).shift();if(!(e instanceof Element))return"not an element";for(n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,a,!1);(node=n.nextNode())&&r!=undefined;)if(r[0]!=o[0]){node.textContent;var c=d+node.length;if(r[0]<c){var i=document.createRange(),l=document.createElement("mark"),s=r[0]-d,u=s+r[1];l.dataset.rangeStart=s,l.dataset.rangeEnd=u,i.setStart(node,s),i.setEnd(node,u),i.surroundContents(l),d=r[0]+r[1],n.nextNode(),o=r,r=t.shift()}else d=c}}$.getJSON("/search_index.json",e=>{window.idx=e}),$.getJSON("/corpus.json",e=>{window.documents=[],Object.entries(e).forEach(e=>{var t={id:e[1].id,content:e[1].content,name:e[1].name,url:e[1].url};window.documents.push(t)})}),$("#site_search").submit(t=>{t.preventDefault();var n=$("#search_box").val();window.index=lunr.Index.load(window.idx),e(window.index.search(n))});var n=e=>{var t=document.createElement("li"),n=document.createElement("article"),a=document.createElement("header"),d=document.createElement("section"),o=document.createElement("h2"),r=document.createElement("a"),c=document.createElement("p");return r.dataset.field="url",r.href+="/blog/"+e.url,r.textContent=e.name,c.dataset.field="content",c.textContent=e.content,c.style.textOverflow="ellipsis",c.style.overflow="hidden",c.style.whiteSpace="nowrap",t.appendChild(n),n.appendChild(a),n.appendChild(d),a.appendChild(o),o.appendChild(r),d.appendChild(c),t}});